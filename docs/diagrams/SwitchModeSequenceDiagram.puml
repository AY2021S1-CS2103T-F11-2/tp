@startuml
!include style.puml

box UI UI_COLOR_T1
participant ":MainWindow" as MainWindow UI_COLOR
end box

box Logic LOGIC_COLOR_T1
participant ":LogicModeManager" as LogicModeManager LOGIC_COLOR
participant ":ModeParser" as ModeParser LOGIC_COLOR
participant ":SwitchCommandParser" as SwitchCommandParser LOGIC_COLOR
participant ":SwitchCommand" as SwitchCommand LOGIC_COLOR
participant ":CommandResult" as CommandResult LOGIC_COLOR
end box

[-> MainWindow : executeCommand(commandText)
activate MainWindow

MainWindow -> LogicModeManager : execute(commandText)
activate LogicModeManager

LogicModeManager -> ModeParser : parseCommand(commandText)
activate ModeParser

create SwitchCommandParser
ModeParser -> SwitchCommandParser: SwitchCommandParser()
activate SwitchCommandParser
SwitchCommandParser --> ModeParser
deactivate SwitchCommandParser

ModeParser -> SwitchCommandParser: parse(arguments)
activate SwitchCommandParser

create SwitchCommand
SwitchCommandParser -> SwitchCommand: SwitchCommand(mode)
activate SwitchCommand
SwitchCommand --> SwitchCommandParser
deactivate SwitchCommand

SwitchCommandParser --> ModeParser
deactivate SwitchCommandParser

ModeParser --> LogicModeManager : command
deactivate ModeParser

destroy SwitchCommandParser

LogicModeManager -> SwitchCommand : execute()
activate SwitchCommand

create CommandResult
SwitchCommand -> CommandResult : CommandResult(successMessage, false, false, mode)
activate CommandResult
CommandResult --> SwitchCommand
deactivate CommandResult

SwitchCommand --> LogicModeManager : commandResult
deactivate SwitchCommand
SwitchCommand -[hidden]-> LogicModeManager : commandResult
destroy SwitchCommand

LogicModeManager --> MainWindow : commandResult
deactivate LogicModeManager

MainWindow -> CommandResult : getMode()
activate CommandResult
CommandResult --> MainWindow : mode
deactivate CommandResult

MainWindow -> MainWindow: switchMode(mode)
destroy CommandResult
activate MainWindow
MainWindow --> MainWindow

deactivate MainWindow
[<--MainWindow
deactivate MainWindow

@enduml
